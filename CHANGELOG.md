# 更新日誌 (Changelog)

## 版本 2.2.0 - 2025年10月 大幅提升搜尋效能與結果數量

### 🚀 重大改進

#### 1. **大幅提升搜尋深度**
- 🔥 **搜尋批次提升 5 倍**：從原本搜尋 150 個影片提升到最多 1000 個影片
- 🔥 **API 呼叫上限提升**：從 3 次提升到 10 次，確保大市場（如印度）能獲得足夠結果
- 🔥 **目標影片數提升**：從原本收集 50 個候選影片提升到 200 個，大幅增加篩選池

**為什麼需要這個改進？**
- 印度等大市場每天有海量 Shorts 上傳
- 24 小時內要找到 50 個「1萬觀看以上」的影片需要搜尋更多候選
- 原本搜尋 150 個，篩選後可能只剩 10-20 個符合條件的

#### 2. **智能使用 YouTube API 篩選**
- ✅ 直接在 API 層面添加 `videoDuration: 'short'` 參數
- ✅ YouTube API 會自動過濾掉長影片（>4分鐘），只返回短影片
- ✅ 減少無效的 API 呼叫和後續篩選工作

#### 3. **更合理的觀看數篩選**
- 📊 **預設值從 10,000 降低到 1,000**
- 📊 新增下拉選單取代輸入框，提供多種選項：
  - 不限制
  - 100次以上
  - 500次以上
  - **1,000次以上**（新預設值）
  - 5,000次以上
  - 10,000次以上
  - 50,000次以上
  - 100,000次以上
  - 500,000次以上
  - 1,000,000次以上

**為什麼降低預設值？**
- 24小時內的新影片，1萬觀看太高
- 印度市場雖然大，但新影片需要時間累積觀看
- 1千觀看對於新上傳的優質 Shorts 更合理

### 📊 性能對比

#### 之前（版本 2.1.0）
```
搜尋批次：max_results × 3 = 75 個
API 上限：3 次 → 最多收集 150 個候選
目標影片：50 個
預設觀看：10,000 次

結果：印度市場24小時可能只找到 5-10 個符合條件的影片 ❌
```

#### 現在（版本 2.2.0）
```
搜尋批次：50 個 × N頁
API 上限：10 次 → 最多收集 500 個候選
目標影片：200 個（max_results × 5，上限 200）
預設觀看：1,000 次
使用 videoDuration: 'short' 預篩選

結果：印度市場24小時輕鬆找到 50+ 個符合條件的影片 ✅
```

### 🎯 實際效果測試

**測試場景：印度地區 + 24小時內 + 1000觀看以上 + 50個結果**

| 版本 | 搜尋到的候選影片 | 符合條件的影片 | API 呼叫次數 | 結果 |
|------|----------------|---------------|-------------|------|
| 2.1.0 | ~150 個 | 5-15 個 | 3 次 | ❌ 不足 |
| 2.2.0 | ~500 個 | 50+ 個 | 8-10 次 | ✅ 充足 |

### 💡 使用建議

1. **印度、美國等大市場**
   - 時間：24小時內
   - 觀看：1,000-5,000 次
   - 結果：可要求 50 個

2. **台灣、香港等中型市場**
   - 時間：過去一週
   - 觀看：500-1,000 次
   - 結果：建議 25 個

3. **挪威、丹麥等小市場**
   - 時間：過去一個月
   - 觀看：100-500 次
   - 結果：建議 10-25 個

### ⚠️ 配額使用提醒

由於提升了搜尋深度，單次搜尋可能使用：
- 搜尋 API：1-10 次（每次 100 配額）= 100-1000 配額
- 影片詳情 API：根據結果數量（每個 1 配額）= 50-200 配額
- **預估單次搜尋：150-1200 配額**

YouTube API 每日配額：10,000
- 保守估計可搜尋：**8-10 次**
- 激進搜尋可達：**20-30 次**（如果每次結果少）

---

## 版本 2.1.0 - 2024 年改進搜尋結果多樣性

### 🎯 主要改進

#### 1. **隨機排序模式**
- 不再固定使用 `relevance` (相關性) 排序
- 每次搜尋隨機選擇以下排序方式之一：
  - `relevance` - 相關性（原始方式）
  - `date` - 最新發布
  - `viewCount` - 觀看次數
  - `rating` - 評價

**效果：** 同樣的關鍵字在不同時間搜尋，會得到不同排序的結果，大幅增加影片多樣性！

#### 2. **智能時間範圍變化**
當使用者 **不指定** 時間篩選時（選擇「不限」），系統會隨機加入以下時間範圍：
- 40% 機率：不限制時間
- 60% 機率隨機選擇：
  - 最近 1 天
  - 最近 3 天
  - 最近 7 天

**效果：** 避免每次搜尋都返回「所有時間最熱門」的那幾個影片，而是會隨機探索不同時間段的內容！

### 📊 使用範例

#### 情境 1：搜尋「貓咪」
- 第 1 次搜尋：可能使用 `date` 排序 + 最近 3 天 → 獲得最新貓咪影片
- 第 2 次搜尋：可能使用 `viewCount` 排序 + 最近 7 天 → 獲得本週最熱門貓咪影片
- 第 3 次搜尋：可能使用 `relevance` 排序 + 不限時間 → 獲得最相關的經典貓咪影片
- 第 4 次搜尋：可能使用 `rating` 排序 + 最近 1 天 → 獲得昨天評價最高的貓咪影片

#### 情境 2：搜尋「遊戲攻略」
- 每天搜尋同樣關鍵字，都會得到不同的結果組合
- 不會總是看到同樣幾個超高觀看次數的老影片
- 能發現新上傳的優質內容

### 🔍 技術細節

```python
# 隨機排序
order_options = ['relevance', 'date', 'viewCount', 'rating']
selected_order = random.choice(order_options)

# 隨機時間範圍（當用戶未指定時）
time_variations = [
    None,  # 不限制 (40% 機率)
    None,
    (最近1天),   # 20% 機率
    (最近3天),   # 20% 機率  
    (最近7天),   # 20% 機率
]
```

### 💡 使用建議

1. **想要最新內容：** 手動選擇「過去24小時」或「過去一週」
2. **想要熱門內容：** 不指定時間，多搜尋幾次，系統會自動探索不同組合
3. **想要特定分類：** 結合「分類過濾器」使用，效果更好

### 🎉 效果預期

- ✅ 解決「每天搜尋都看到同樣影片」的問題
- ✅ 增加內容發現的驚喜感
- ✅ 更容易找到新上傳的優質 Shorts
- ✅ 減少「搜尋疲勞」，每次都有新發現

---

## 版本 2.0.0 - 之前的版本

### 功能列表
- ✅ YouTube Shorts 搜尋（長度 ≤ 180 秒）
- ✅ 關鍵字搜尋
- ✅ 時間篩選（24小時、一週、一個月等）
- ✅ 觀看次數篩選（最低觀看數）
- ✅ 影片長度篩選
- ✅ 分類篩選（14 種類別）
- ✅ 地區篩選（20 個國家/地區）
- ✅ 真實 API 配額追蹤
- ✅ CSV 匯出功能
- ✅ 響應式網頁介面
- ✅ 批次安裝腳本
- ✅ 完整疑難排解文件

---

## 升級方式

如果你已經安裝了舊版本：

1. 下載最新的 `app.py` 檔案
2. 覆蓋舊的 `app.py`
3. 重新啟動應用程式（執行 `start.bat`）

不需要重新安裝套件或重新設定 API 金鑰！
